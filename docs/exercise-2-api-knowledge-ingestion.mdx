---
sidebar_position: 5
---

# ⚙️ 2.1. Optional: Ingest Using the API

<div style={{ display: 'grid', gridTemplateColumns: '2fr 1fr', gap: '2em', alignItems: 'center', marginBottom: '2em' }}>
  <div>
    If you want to go beyond manual upload and see how teams can automate the ingestion of Jira issues or JSON exports into Dify, we've deployed a ready-to-use API for you!

    > You'll use it to load Jira issue samples as structured documents with metadata. This is much cleaner than plain `.txt` files.

  </div>
  <div style={{ textAlign: 'center' }}>
    <img src={require('../static/img/ex2/knowledge-base.png').default} alt="Retrieval" style={{ maxWidth: '100%', height: 'auto' }} />
  </div>
</div>

---

<div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '2em', alignItems: 'center', marginBottom: '2em' }}>
  <div>
    <h2>🚀 Why Use the API?</h2>
    <p>Manually uploading <code>.txt</code> files gives you a starting point, but <b>API ingestion</b> offers superpowers:</p>
    <ul>
      <li>🧠 Rich documents with metadata</li>
      <li>🤖 Upload multiple files or issues at once</li>
      <li>✅ Each document linked to an <code>issue_key</code></li>
      <li>🧰 Perfect for pipelines or daily ingestion</li>
    </ul>
    <p>Use this deployed API if you want to:</p>
    <ul>
      <li>Experiment with JSON ingestion instead of raw <code>.txt</code></li>
      <li>See how metadata improves search (like <code>issue_key</code>)</li>
      <li>Reuse this approach at work with real Jira projects</li>
    </ul>
  </div>
  <div style={{ textAlign: 'center' }}>
    <img src={require('../static/img/ex2/dataset-api-config.png').default} alt="API Config Screenshot" style={{ maxWidth: '100%', height: 'auto', borderRadius: '8px', boxShadow: '0 2px 8px #ddd' }} />
    <div style={{ fontSize: '0.95em', color: '#444', marginTop: '0.5em' }}>
      <b>API Ingestion Example</b>
    </div>
  </div>
</div>

---

## 🛠️ Step-by-Step Setup (Deployed API)

We've deployed a ready-to-use API for you! You can access the full API documentation at:

**🔗 [API Documentation](https://zzp77ty4ejy2jwdjlw3mdprpti0aukfd.lambda-url.eu-west-3.on.aws/docs)**

### 1. Get Your Dify Configuration

First, you'll need your Dify instance details:

- In your Dify instance, go to <b>Knowledge</b> and copy your Dify <b>API Server</b> URL
- Then click the <b>API Key</b> button and create an API key for your Dify datasets

   <img src={require('../static/img/ex2/kb-api-access.png').default} alt="API Access" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />
   <img src={require('../static/img/ex2/kb-create-apikey.png').default} alt="Create API Key" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />

### 2. Explore Available Projects

Use the **GET /projects** endpoint to see what Jira projects are available for ingestion:

```bash
curl -X GET "https://zzp77ty4ejy2jwdjlw3mdprpti0aukfd.lambda-url.eu-west-3.on.aws/projects"
```

This will return a list of available projects you can ingest into your Dify instance.

### 3. Ingest Jira Issues

Use the **POST /jira/ingestion** endpoint to ingest specific projects:

```bash
curl -X POST "https://zzp77ty4ejy2jwdjlw3mdprpti0aukfd.lambda-url.eu-west-3.on.aws/jira/ingestion" \
  -H "Content-Type: application/json" \
  -d '{
    "dify_base_url": "http://your_dify_ip/v1",
    "dify_api_key": "your_dify_api_key",
    "project_key": "REST"
  }'
```

Replace:
- `your_dify_ip` with your Dify instance URL
- `your_dify_api_key` with your Dify API key
- `project_key` with the project you want to ingest (e.g., "REST", "QUIDDITCH")

---

## 📤 Data is Now Ingested!

After running the ingestion command, the API will:

1. **Fetch the Jira issues** from the specified project
2. **Process and structure** the data with proper metadata
3. **Upload to your Dify instance** automatically
4. **Create a knowledge base** ready for use

### 🧪 Example Response

The API will return a response showing the ingestion status:

```json
{
  "status": "success",
  "message": "Successfully ingested 25 issues from project REST",
  "knowledge_base_id": "kb_123456789",
  "documents_created": 25
}
```

### Verify in Dify

Take a look at your Dify instance and you will see your ingested data has been created!

<img src={require('../static/img/ex2/kb-created-api.png').default} alt="KB Created API" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />
<img src={require('../static/img/ex2/dataset-api-config.png').default} alt="Dataset API Config" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />

## 📚 Compare Manual, Basic, and Advanced Knowledge Bases

<div style={{ background: '#fffbe8', border: '2px solid #facc15', borderRadius: '10px', padding: '1.5em 2em', margin: '2em 0', fontSize: '1.08em', boxShadow: '0 2px 8px #facc1533' }}>
  <b>In this exercise, you will work with <span style={{ color: '#b45309' }}>three knowledge bases</span> in Dify:</b>
  <ul>
    <li><b>Manual Ingestion</b>: Created in the previous exercise by uploading <code>.txt</code> files manually.</li>
    <li><b>Basic API Ingestion</b>: Your first API-based knowledge base, created by ingesting the provided Jira issues and summaries as-is, without enhancements.</li>
    <li><b>Advanced API Ingestion</b>: A second API-based knowledge base, but this time use <b>query seeding</b> (adding example queries to improve retrieval) and <b>aliases</b> (alternative names for issues, projects, or fields) to make your knowledge base smarter and more flexible.</li>
  </ul>
  <b>What's the difference?</b>
  <ul>
    <li><b>Manual</b>: Simple upload of raw text files, with limited structure and no metadata.</li>
    <li><b>Basic API</b>: Straightforward import of structured data, useful for simple lookups and basic retrieval.</li>
    <li><b>Advanced API</b>: Leverages query seeding and aliases, helping the AI understand more user intents, synonyms, and related queries. This results in better, more relevant answers—especially for ambiguous or varied user questions.</li>
  </ul>
  <div style={{ margin: '1.5em 0' }}>
    <b>Try these queries on all three knowledge bases and compare the results:</b>
    <ul style={{ fontSize: '1.05em' }}>
      <li>👉 <code>What is this issue about: Jira Issue: REST-259?</code></li>
      <li>👉 <code>Give a test plan for REST-266</code></li>
      <li>👉 <code>Who is the assignee for REST-266?</code></li>
      <li>👉 <code>Summarize the technical documentation for the REST module.</code></li>
    </ul>
    <span style={{ color: '#b45309', fontWeight: 500 }}>Notice how having better data and advanced techniques generates better results!</span>
  </div>
  <img src={require('../static/img/ex2/queries-compare.png').default} alt="API Ingestion Endpoint" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />
    <img src={require('../static/img/ex2/queries-compare-advanced.png').default} alt="API Ingestion Endpoint" style={{ maxWidth: '100%', borderRadius: '8px', margin: '1em 0' }} />
  <div style={{ marginTop: '1em' }}>
    <b>Tip:</b> After uploading, go to <b>Retrieval testing</b> in Dify and try the queries above. Compare the answers you get from each knowledge base. <b>Structured data and advanced techniques enable smarter, more accurate answers!</b>
  </div>
</div>

<details style={{
  border: '2px solid #7c3aed',
  borderRadius: '8px',
  background: '#faf9ff',
  padding: '0.5em 1em',
  marginTop: '1em',
  marginBottom: '1em'
}}>
<summary><b>What Happens Behind the Scenes?</b></summary>
<ul>
  <li>Each issue is converted into a descriptive <b>document</b>: summary, description, project, type, etc.</li>
  <li>Smart chunking ensures readable chunks with overlap for better search.</li>
  <li>Metadata (like <code>issue_key</code>) is attached, improving traceability.</li>
</ul>
</details>

---



<details style={{
  border: '2px solid #7c3aed',
  borderRadius: '8px',
  background: '#faf9ff',
  padding: '0.5em 1em',
  marginTop: '2em',
  marginBottom: '2em'
}}>
<summary><b>🔧 Try It Yourself: Deploy Your Own API (Advanced)</b></summary>

If you want to deploy your own version of the API or understand how it works under the hood, you can still use the Codespace approach:

1. Visit <a href="https://github.com/bassagap/dify_jira" target="_blank" rel="noopener noreferrer">https://github.com/bassagap/dify_jira</a> and create a <b>Codespace</b> on the <b>main</b> branch
2. Follow the original setup instructions to deploy your own instance
3. This gives you full control over the API and allows customization

<div style={{ marginTop: '1em', fontSize: '0.9em', color: '#666' }}>
  <b>Note:</b> This is optional and only needed if you want to customize the API or understand the implementation details.
</div>

</details>

This deployed API is a great next step if you want to automate ingestion in your organization, connect to real Jira, or just test richer search results with Dify.

